{"No":"ORR29",
"Subject":"Do not let the this reference escape during object construction",
"Level":"Medium",
"Description":"The this reference is said to have escaped when it is made available beyond its current scope. Following are common ways by which the this reference can escape.\n Returning this from a non-private, overridable method that is invoked from the constructor of a class whose object is being constructed. Publishing by assigning this to a public static variable from the constructor of a class whose object is being constructed. And so on.\n Allowing the this reference to escape can result in improper initialization and runtime exceptions.",
"Vulncode":"1)\nfinal class Publisher {\n\tpublic static volatile Publisher published;\n\tint num;\n\tPublisher(int number) {\n\t\tpublished = this;\n\t\t// 초기화\n\t\tthis.num = number;\n\t}\n}\n\n2)\nfinal class Publisher {\n\tpublic static Publisher published;\n\tint num;\n\tPublisher(int number) {\n\t\tthis.num = number;\n\t\t// 초기화\n\t\tpublished = this;\n\t}\n}\n\n3)\npublic class DefaultExceptionReporter implements ExceptionReporter {\n\tpublic DefaultExceptionReporter(ExceptionReporter er) {\n\t\ter.setExceptionReporter(new DefaultExceptionReproter(er) {\n\t\t\tpublic void report(Throwalbe t) {\n\t\t\t\tfilter(t);\n\t\t\t}\n\t\t});\n\t}\n}",
"Secucode":"1)\nfinal class Publisher {\n\tstatic volatile Publisher published;\n\tint num;\n\tPublisher(int number) {\n\t\tthis.num = number;\n\t\t// 초기화\n\t\tpublished = this;\n\n\t}\n}\n\n2)\nfinal class Publisher {\n\tfinal int num;\n\tprivate Publisher(int number) {\n\t\tthis.num = number;\n\t}\n\n\tpublic static Publisher newInstance(int number) {\n\t\tPublisher published = new Publisher(number);\n\t\treturn published;\n\t}\n}\n\n3)\npublic class DefaultExceptionReporter implements ExceptionReporter {\n\tprivate final DefaultExceptionReporter dafaultER;\n\tprivate DefualtExceptionReporter(ExceptionReporter excr) {\n\t\tdefualtER = new DefaultExceptionReporter(excr) {\n\t\t\tpublic void report(Throwable t) {\n\t\t\t\tfilter(t);\n\t\t\t}\n\t\t};\n\t}\n\tpublic static DefaultExceptionReporter newInstance(ExceptionReporter excr) {\n\t\tDefaultExceptionReporter der = new DefaultExceptionReporter(excr);\n\t\texcr.setDefaultExceptionReporter(der.dafultER);\n\t\treturn der;\n\t}\n}"}